<nav title="{{ _('Conversation') }}" aria-labelledby="menu-conversation">
    <h3 id="menu-conversation">{{ _('Conversation') }}</h3>
    <ul>
        <li><a href="{{ conversation.url('conversation:detail') }}">{{ _('Conversation') }}</a></li>
        <li>    
            {% if request.user.id == conversation.author_id and conversation.boards.count() %}
            <a href="{{ url('boards:conversation-list', board=conversation.boards.first()) }}">{{ _('Boards') }}</a>
            {% elif request.user.id != conversation.author_id and request.user.boards.count() %}
            <a href="{{ url('boards:conversation-list', board=request.user.boards.first()) }}">{{ _('Boards') }}</a>
            {% endif %}
        </li>
        {% for link in page_menu.links('conversations:detail-actions', request, conversation) %}
            <li>{{ link }}</li>
        {% endfor %}
        <li class="report-section">
            <div style="display:flex;" onclick="showSection('isexpanded3', 'report-options-list');">
                <div class="display-reports">
                    <input type="checkbox" id="isexpanded3"/>
                    <label for="isexpanded3"><i style="margin-left: unset;" class="fa fa-chevron-down"></i></label>
                </div>
                <a href="" onclick="setChecked('isexpanded3')">{{ _('Reports') }}</a>
            </div>
            <ul id="report-options-list">
                {% if request.user.has_perm("ej.can_view_report", conversation) %}
                <li><a href=" {{ conversation.url('report:general-report') }}">{{ _('General report') }}</a></li>
                {% endif %}
                <li><a href="">{{ _('Comments report') }}</a></li>
                <li><a href=" {{ conversation.url('cluster:index') }}">{{ _('Opinion groups') }}</a></li>
            </ul>    
        </li>
    </ul>
</nav>
<nav title="{{ _('Admin') }}" aria-labelledby="menu-admin">
    <h3 id="menu-admin">{{ _('Admin') }}</h3>
    <ul>
        {% if request.user.has_perm('ej.can_edit_conversation', conversation) %}
            <li><a href="{{ conversation.url('conversation:edit') }}">{{ _('Edit') }}</a></li>
        {% else %}
            <li><a href="{{ url('conversation:list') }}">{{ _('Back to conversations') }}</a></li>
        {% endif %}
        {%- if request.user.has_perm('ej.can_moderate_conversation', conversation) %}
            <li><a href="{{ conversation.url('conversation:moderate') }}">{{ _('Moderate') }}</a></li>
        {% endif %}
        {% for link in page_menu.links('conversations:detail-admin', request, conversation) %}
            <li>{{ link }}</li>
        {% endfor %}
    </ul>
</nav>
{{ page_menu.ACCESSIBILITY() }}

<script>
function setChecked(check_id) {
    event.preventDefault();
    let checkbox = document.getElementById(check_id);
    checkbox.checked = !checkbox.checked;
}

function showSection(check_id, section_id) {
    let checkbox = document.getElementById(check_id)
    let section = document.getElementById(section_id);
    if (checkbox.checked) {
        section.style['opacity'] = 1;
        section.style['display'] = 'block';
    } else {
        section.style['opacity'] = 0;
        section.style['display'] = 'none';
    }
}

</script>
