{% extends 'base.jinja2' %}
{% from 'ej_conversations/components/comment-list.jinja2' import comment_list %}
{% from 'ej_conversations/components/conversation-card.jinja2' import conversation_card %}

{% block content %}
    <div class="Moderate">
        <form method="post" class="django-form-as-p">
          {{ csrf_input }}

          <input type="hidden" name="title" value="{{ conversation.title }}" />

          <div class="ConversationEdit-actions">
            <span>
              <i class="fa fa-times"></i>
              <input type="reset" value="{{ _('Cancel') }}" name="cancel" onClick="history.back(-1)">
            </span>
            <span>
              <i class="fa fa-check"></i>
              <input type="submit" value="{{ _('Save') }}" name="create">
            </span>
          </div>

          {% if conversation.tags.all()[0] %}
              {% set tags = (conversation.tags.all()[0]|string).title() %}
          {% else %}
              {% set tags = 'Tags' %}
          {% endif %}
          
          <input type="hidden" name="tags" value="{{ tags }}" />

          <div class="ConversationDetail">
              <div class="ConversationDetail-banner">
                  <div class="ConversationTags"><i class="fa fa-tags"></i>
                    {{ tags }}
                  </div>
                  
                  <p><textarea onfocus="this.style.height = (this.scrollHeight) + 'px'" onkeyup="this.style.height = (this.scrollHeight) + 'px'" class="Conversation-edit-field" name="text" required id="id_text">{{ conversation.text }}</textarea></p>
              </div>

              <div class="ConversationDetail-arrow"></div>
          </div>
        </form>
        <div class="Moderate-comments">
            <h1>{{ _('Comments in this conversation') }}</h1>
            {{ comment_list(comments, csrf_input) }}
        </div>
    </div>
{% endblock %}
