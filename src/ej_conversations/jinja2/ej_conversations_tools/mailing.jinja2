{% extends 'base.jinja2' %}

{% block metaOG2 %}

    <meta name="description" property="og:title" content="Area de integração da EJ com outras ferramentas.">
    <meta property="og:description" content="Area de integração da EJ com outras ferramentas.">

{% endblock metaOG2 %}

{% block _menu %} {{ menu(request.user, board_palette) }} {% endblock %}

{% block content %}
<div class="tools">
<div class="tools-title">
<h1>{{_("Tools")}} > {{ tool["integration"] }}</h1>
<span>{{tool["description"] }}</span>
</div>
<div>
	<div class="tools-section">
	<div class="tools-content">
		<form action="{{conversation.url("conversation-tools:mailing")}}" method="post" class="tools-settings-form">
			<section>
				<h3>{{form.mailing_tool_type.label}}</h3>
				{{form.mailing_tool_type}}
			</section>
			<section>
				<h3>{{form.theme.label}}</h3>
				{{form.theme}}
			</section>
			<section>
				<label id="custom-domain-label">{{form.is_custom_domain.label}}</label>
				{{form.is_custom_domain}}
				<input name="custom-domain" id="domain-input" type="text" placeholder="{{ _('domain to redirect the user on template') }}">
			</section>
			<input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
			<div class="group-button">
				<input type="submit" name="download" value="{{ _('Download') }}">
				<input type="submit" name="preview" value="{{ _('Preview') }}">
			</div>
		</form>
	</div>
		{% if template_preview %}
			<div id="preview-template">
				<iframe id="iframe" scroll="0"
				frameborder="0"></iframe>
			</div>
		{% endif %}
	</div>


<p><a href="{{ conversation.url('conversation-tools:index') }}" title="{{ _('Back to tools') }}"
		class="lowercase bold text-brand">
	<i class="fa fa-chevron-left"></i>{% trans %}Back to tools{% endtrans %}
</a></p>
</div>
</div>
   <script>
	   function showContent() {
		   let content = document.querySelector(".integration-content");
		   let section = document.querySelector(".integration-section");
		   if (window.getComputedStyle(content).maxHeight == "0px") {
			content.style.maxHeight = "400px";
			section.style.borderRadius = "unset";
			section.style.borderStyle = "unset";
		   }
		   else {
			content.style.maxHeight = "0px";
			section.style.borderStyle = "solid";
			section.style.borderRadius = "1rem";
		   }
	   }

	   function showDomainInput() {
		   let input = document.querySelector("#domain-input");
		   if (document.getElementById('id_is_custom_domain').checked){
			   input.style.display = "block";
		   } else {
			   input.style.display = "none";
		   }
	   }

	function setIframe(html){
		let iframe = document.getElementById('iframe');
		iframe.srcdoc = html;
		iframe.width  = iframe.contentWindow.document.body.scrollWidth;
	iframe.height = iframe.contentWindow.document.body.scrollHeight;
		if(iframe) {
			iframe.contentWindow.document.body.style.overflow = "auto";
		}
	}
	window.onload = function() {
		document.getElementById('id_is_custom_domain').onchange = showDomainInput;
		if({{template_preview | safe}}){
			setIframe({{template_preview | safe}})
		}
	};

   </script>
{% endblock %}
