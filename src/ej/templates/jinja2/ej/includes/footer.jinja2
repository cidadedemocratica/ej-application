{% macro link_macro(url) %}
    {{- link(caller(), url, **kwargs) -}}
{% endmacro %}

<nav class="main-footer" aria-label="{{ _('Navigation bar') }}">
    {% if settings.has_rocketchat and request.user.has_perm('ej_rocketchat.can_create_account') %}
        {% call link_macro('rocket:index', title=_('Talks'), class_='main-footer__link') %}
            <img src="{{ static('img/icons/navbar_panel.svg') }}" alt="">
            <span>{{ _('Talks') }}</span>
        {% endcall %}
    {% endif %}

    {% if request.user.profile|default(None) %}
        {% if settings.has_profiles%}
            {% call link_macro('profile:detail', title=_('Profile'),) %}
                <img class="main-footer__avatar"
                    src="{{ request.user.profile.image_url }}" alt="{{ _('Profile picture') }}">
            {% endcall %}
        {% else %}
            {% call link_macro('profile:detail', title=_('Profile'),) %}
                <img class="main-footer__avatar"
                    src="{{ request.user.profile.image_url }}" alt="{{ _('Profile picture') }}">
            {% endcall %}
        {% endif %}
    {# For route without profile #}   
    {% else %}
        {% call link_macro('profile:detail', title=_('Profile'), class_='main-footer__link') %}
            <img src="{{ static('img/icons/navbar_profile.svg') }}" alt="">
            <span>{{ _('Profile') }}</span>
        {% endcall %}
    {% endif %}  
</nav>
